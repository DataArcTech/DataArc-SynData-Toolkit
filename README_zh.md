# DataArc SynData Toolkit

[![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/downloads/) [![Framework: uv](https://img.shields.io/badge/Package_Manager-uv-42b983.svg)](https://github.com/astral-sh/uv) [![Gradio UI](https://img.shields.io/badge/GUI-Gradio-ff6f00.svg)](https://github.com/gradio-app/gradio) [![Pydantic v2](https://img.shields.io/badge/Pydantic-v2-ffa000.svg)](https://docs.pydantic.dev/)

*ä¸€ä¸ªæ¨¡å—åŒ–ã€é«˜åº¦æ˜“ç”¨çš„åˆæˆæ•°æ®ç”Ÿæˆå·¥å…·é›†ï¼Œæ”¯æŒå¤šæ¥æºã€å¤šè¯­è¨€çš„æ•°æ®åˆæˆã€‚*

### ä½¿ç”¨é›¶ä»£ç [å‘½ä»¤è¡Œ](#:rocket:-å¿«é€Ÿå¼€å§‹)ä¸[å¯è§†åŒ–ç•Œé¢](#:desktop_computer:-å¯è§†åŒ–ç•Œé¢)ï¼Œè½»æ¾åˆæˆå¤§æ¨¡å‹è®­ç»ƒæ•°æ®ï¼

:book:[ [English](./README.md) | **ä¸­æ–‡** ]



## :dart: é¡¹ç›®æ¦‚è¿°

**DataArc SynData Toolkit**æ˜¯ç”±æ•°åˆ›å¼§å…‰å¼€å‘å¹¶å¼€æºçš„åˆæˆæ•°æ®å·¥å…·é›†ï¼Œèƒ½å¤Ÿæ ¹æ®ä½¿ç”¨è€…éœ€æ±‚ï¼Œé€šè¿‡ç®€å•é…ç½®æ–‡ä»¶ä¸€æ­¥åˆ°ä½åˆæˆæ‰€éœ€è®­ç»ƒæ•°æ®ã€‚



## :bulb: é¡¹ç›®ç‰¹è‰²

- **æç®€ä½¿ç”¨**ï¼šé€šè¿‡ä¸€ä¸ª[ç®€å•æŒ‡ä»¤](#3-åˆæˆæ•°æ®)å’Œä¸€ä¸ªé…ç½®æ–‡ä»¶åˆæˆæ•°æ®ã€‚ä¹Ÿæä¾›[å¯è§†åŒ–ç•Œé¢](#:desktop_computer:-å¯è§†åŒ–ç•Œé¢)è¿›è¡Œæ“ä½œã€‚
- **æ”¯æŒå¤šæ¥æºè·å–æ•°æ®**
  - **æœ¬åœ°åˆæˆ**ï¼šæ”¯æŒåŸºäºæœ¬åœ°è¯­æ–™åˆæˆæ•°æ®ã€‚
  - **huggingfaceé›†æˆ**ï¼šæ”¯æŒåŸºäºéœ€æ±‚è‡ªåŠ¨ç­›æŸ¥huggingfaceæ•°æ®ã€‚ 
  - **æ¨¡å‹è’¸é¦**ï¼šæ”¯æŒåŸºäºæ¨¡å‹è’¸é¦åˆæˆæ•°æ®ã€‚
- **æ”¯æŒå¤šè¯­è¨€**ï¼šæ”¯æŒè‹±è¯­ä»¥åŠå„ç±»å°è¯­ç§ã€‚
- **æ”¯æŒå¤šæºæ¨¡å‹æ¥å…¥**ï¼šæ”¯æŒé€šè¿‡æœ¬åœ°éƒ¨ç½²ã€OpenAIæ¥å£ç­‰å¤šç§å½¢å¼æ¥å…¥æ¨¡å‹ã€‚
- **é«˜åº¦å¯æ‰©å±•**ï¼šåˆæˆæ•°æ®å…¨æµç¨‹æ¨¡å—åŒ–ï¼Œå¼€å‘è€…å¯çµæ´»åŸºäºæ¨¡å—å®šåˆ¶åŒ–ç­–ç•¥å’Œæ–¹æ³•å®ç°ã€‚

## ğŸ”¬ æ€§èƒ½è¡¨ç°

| æ¨¡å‹                       | Medical | Finance | Law   |
|----------------------------|---------|---------|-------|
| Qwen-2.5-7B-Instruct       | 42.34%  | 52.91%   | 19.80% |
| Trained with Synthetic Data | 64.57%  | 73.93%  | 42.80% |

ä»…éœ€å°‘é‡ä»£ç å³å¯å¸¦æ¥è¶…è¿‡20%çš„æ€§èƒ½æå‡ã€‚

## :notebook: æ›´æ–°æ—¥å¿—

[25/11/17] æˆ‘ä»¬å¼€æºäº†åˆæˆæ•°æ®å¹³å°

> [!TIP]
>
> å¦‚æœæ‚¨æ— æ³•ä½¿ç”¨æœ€æ–°çš„åŠŸèƒ½ï¼Œè¯·å°è¯•é‡æ–°æ‹‰å–ä»£ç 



## :factory: DataArc SynData Toolkit æ•°æ®åˆæˆæµç¨‹

**DataArc SynData Toolkit**çš„è®¾è®¡æ—¨åœ¨ä»¥æ¨¡å—åŒ–æ–¹å¼è¿è¡Œæ•°æ®åˆæˆæµç¨‹ï¼Œå…è®¸ç”¨æˆ·è‡ªå®šä¹‰å„æ¨¡å—çš„ç­–ç•¥å’Œæ–¹æ³•å®ç°ã€‚ä¸»è¦ç»„ä»¶åŒ…æ‹¬ï¼š

- **æ•°æ®åˆæˆ**ï¼šé€šè¿‡æœ¬åœ°åˆæˆã€huggingfaceçˆ¬å–ã€æ•°æ®è’¸é¦ç­‰æ–¹æ³•åˆæˆæ•°æ®ã€‚
  - å¼€å‘è€…å¯ä»¥ç»§æ‰¿[BaseTaskConfig](./sdgsystem/configs/config.py)å’Œ[BaseTaskExecutor](./sdgsystem/tasks/base.py)å®šåˆ¶åŒ–åˆæˆæ•°æ®çš„æ–¹æ³•
- **æ•°æ®ç­›é€‰ä¸æ”¹å†™**ï¼šå¯¹åˆæ­¥åˆæˆçš„æ•°æ®ï¼Œé’ˆå¯¹å¾…è®­ç»ƒæ¨¡å‹è¿›è¡Œç­›é€‰å’Œæ”¹å†™ã€‚
  - å¼€å‘è€…å¯ä»¥ç»§æ‰¿[BaseRewriteConfig](./sdgsystem/configs/config.py)å’Œ[BaseRewriter](./sdgsystem/generation/rewriter.py)å®šåˆ¶åŒ–æ•°æ®æ”¹å†™æ–¹æ³•ï¼ˆæˆ–ä¸æ”¹å†™ï¼‰

![dataarc-sdg_pipeline](assets/dataarc-syndata-toolkit_pipeline.png)

é€šè¿‡è§£è€¦æ¨¡å—ï¼Œå¼€å‘è€…å¯ä»¥åŸºäºç‰¹å®šéœ€æ±‚å®ç°å„åŠŸèƒ½æ¨¡å—çš„çµæ´»å®šåˆ¶åŒ–ã€‚



## :jigsaw: ä½¿ç”¨åœºæ™¯

æˆ‘ä»¬æä¾›ä¸‰ä¸ªä¸åŒçš„ä½¿ç”¨**DataArc SynData Toolkit**è¿›è¡Œæ•°æ®åˆæˆçš„ [ä½¿ç”¨åœºæ™¯](examples/README.md)ã€‚



## :file_folder: é¡¹ç›®ç»“æ„

```
dataarc-sdg/
â”œâ”€â”€ configs/						# é…ç½®æ ·ä¾‹
â”‚   â”œâ”€â”€ example.yaml				# é…ç½®æ ·ä¾‹YAMLæ–‡ä»¶
|
â”œâ”€â”€ sdgsystem/						# å·¥å…·é›†åŠŸèƒ½å®ç°
â”‚   â”œâ”€â”€ configs/					# é…ç½®æ¨¡å—
|	|	â”œâ”€â”€ config.py				# é…ç½®è§£æ
|	|	â””â”€â”€ constants.py			# é»˜è®¤å‚æ•°
|
â”‚   â”œâ”€â”€ dataset/					# æ•°æ®é›†æ¨¡å—
|	|	â”œâ”€â”€ dataset.py				# æ•°æ®é›†ç±»
|	|	â””â”€â”€ process.py				# æ•°æ®å¤„ç†ï¼šè´¨é‡ç­›æŸ¥ä¸æ ¼å¼åŒ–
|
â”‚   â”œâ”€â”€ huggingface/				# huggingfaceçˆ¬å–
â”‚   â”œâ”€â”€ documents/					# æœ¬åœ°æ–‡æ¡£æ£€ç´¢ã€è§£æä¸åˆ†å—
â”‚   â”œâ”€â”€ distillation/				# æ¨¡å‹è’¸é¦
|
â”‚   â”œâ”€â”€ evaluation/					# è¯„ä¼°æ¨¡å—
|	|	â”œâ”€â”€ answer_comparison.py	# ç­”æ¡ˆæ¯”å¯¹
|	|	â”œâ”€â”€ evaluator.py			# è¯„ä¼°å™¨
|
â”‚   â”œâ”€â”€ generation/					# ç”Ÿæˆæ¨¡å—
|	|	â”œâ”€â”€ base.py					# ç”ŸæˆåŠŸèƒ½åŸºç±»
|	|	â”œâ”€â”€ generator.py			# æ•°æ®åˆæˆ
|	|	â”œâ”€â”€ rewriter.py				# æ•°æ®æ”¹å†™
|
â”‚   â”œâ”€â”€ models/						# æ¨¡å‹äº¤äº’æ¨¡å—
|	|	â”œâ”€â”€ postprocess/			# æ¨¡å‹å›å¤åå¤„ç†æ¨¡å—ï¼šå¦‚å¤šæ•°æŠ•ç¥¨ç­‰
|	|	â”œâ”€â”€ answer_extraction.py	# ç­”æ¡ˆæŠ½å–
|	|	â”œâ”€â”€ models.py				# æ¨¡å‹éƒ¨ç½²ä¸å¯¹è¯
|	|	â”œâ”€â”€ processor_arguments.py	# åå¤„ç†å‚æ•°
|	|	â”œâ”€â”€ client.py				# å®Œæ•´æ¨¡å‹äº¤äº’ç»ˆç«¯
|
â”‚   â”œâ”€â”€ tasks/						# æ•°æ®åˆæˆä»»åŠ¡æ‰§è¡Œæ¨¡å—
|	|	â”œâ”€â”€ base.py					# ä»»åŠ¡æ‰§è¡Œå™¨åŸºç±»
|	|	â”œâ”€â”€ (local/web/distill).py	# ä¸åŒæ¥æºåˆæˆæ•°æ®çš„æ‰§è¡Œ
|	|	â”œâ”€â”€ total_executor.py		# æ€»æ‰§è¡Œå™¨
|
â”‚   â”œâ”€â”€ translation/				# å°è¯­ç§æ”¯æŒ
|
â”‚   â”œâ”€â”€ cli.py						# é¡¹ç›®åŠŸèƒ½ç«¯å£
â”‚   â”œâ”€â”€ pipeline.py					# å·¥ä½œæµç¨‹
â”‚   â”œâ”€â”€ prompts.py					# æç¤ºè¯
â”‚   â”œâ”€â”€ token_counter.py			# å¤§æ¨¡å‹tokenç”¨é‡ä¼°è®¡
â”‚   â””â”€â”€ utils.py					# åŠŸèƒ½ç»„ä»¶
|
â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ datasets/					# è®­ç»ƒæ•°æ®
|	|	â”œâ”€â”€ examples/				  # è®­ç»ƒç¤ºä¾‹
|	|	â”œâ”€â”€ scripts/				  # è„šæœ¬
|	|	â””â”€â”€ verl/			        # VeRLè®­ç»ƒæ¨¡å—
|
â”œâ”€â”€ tests/							# æµ‹è¯•å¥—ä»¶
|
â”œâ”€â”€ app.py							# å¯è§†åŒ–ç•Œé¢
â”œâ”€â”€ pyproject.toml					# é¡¹ç›®ä¾èµ–
â””â”€â”€ README.md						# é¡¹ç›®æ–‡æ¡£
```

 

## :rocket: å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…DataArc SynData Toolkit

```shell
# 1. å…‹éš†é¡¹ç›®ä»“åº“
git clone https://github.com/DataArcTech/DataArc-SynData-Toolkit.git
cd DataArc-SynData-Toolkit

# 2. å®‰è£…uvï¼ˆå¦‚æœå°šæœªå®‰è£…ï¼‰
pip install uv

# 3. å®‰è£…ä¾èµ– 
uv sync
```

å…·ä½“çš„ç¡¬ä»¶è¦æ±‚ä»¥åŠç¯å¢ƒé…ç½®è¯·è¯¦è§[é…ç½®æ–‡æ¡£](DEPENDENCIES.md)ã€‚

### 2. é…ç½®

è¯·å‚ç…§[æ ·ä¾‹é…ç½®æ–‡ä»¶](./configs/example.yaml)ï¼Œæ ¹æ®æ‚¨çš„éœ€æ±‚ä¿®æ”¹é…ç½®ã€‚

### 3. åˆæˆæ•°æ®

é€šè¿‡å‘½ä»¤è¡Œï¼š

åˆ›å»º.envæ–‡ä»¶ï¼Œå¡«å†™å¦‚ä¸‹å­—æ®µã€‚
```shell
OPENAI_API_KEY=sk-xxx   # ä½ çš„api key
OPENAI_BASE_URL=https://api.openai.com/v1  # å¯é€‰ï¼šæŒ‡å®šçš„base url
```

å¹¶æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ã€‚

```shell
uv run sdg configs/example.yaml  # å¯ä»¥æ›´æ”¹ä¸ºä½ çš„.yamlæ–‡ä»¶
```

## :twisted_rightwards_arrows: ä½¿ç”¨åˆæˆæ•°æ®è¿›è¡Œè®­ç»ƒ

åœ¨datasets/è·¯å¾„å‡†å¤‡å¥½ä½ çš„è®­ç»ƒæ•°æ®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨gsm8kæ•°æ®é›†åœ¨Qwen2.5-0.5Bä¸Šè¿›è¡ŒLoRAå¾®è°ƒçš„ç¤ºä¾‹ï¼š

```shell
cd train
bash examples/sft/gsm8k/run_qwen_05_peft.sh
```

## :desktop_computer: å¯è§†åŒ–ç•Œé¢

ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨UIç•Œé¢ï¼Œè¯¥ç•Œé¢ç”±[Gradio](https://github.com/gradio-app/gradio)é©±åŠ¨ã€‚

```shell
uv run python app.py
```

![](./assets/frontend.png)



## :wrench: é…ç½®ç³»ç»Ÿ

æ•°æ®åˆæˆå¹³å°ä½¿ç”¨ä¸€ä¸ªçµæ´»çš„[YAMLæ–‡ä»¶](./configs/example.yaml)è¿›è¡Œé…ç½®ï¼š



## :date: ä¸‹ä¸€æ­¥å‘å¸ƒçš„è®¡åˆ’

- **é˜¿æ‹‰ä¼¯è¯­æ”¯æŒ**ï¼šæ”¯æŒåˆæˆé˜¿æ‹‰ä¼¯è¯­è®­ç»ƒæ•°æ®ã€‚
- **è‡ªå®šä¹‰æ•°æ®æº**ï¼šæ”¯æŒè‡ªå®šä¹‰åœ°æ·»åŠ æ•°æ®æ¥æºä»¥åŠå¯¹åº”åè®®æ–‡ä»¶çš„è½¬æ¢ã€‚
- **æ¨¡å‹å¾®è°ƒæ¨¡å—**ï¼šæ”¯æŒåœ¨å·¥å…·é›†æµç¨‹ä¸­ï¼Œä½¿ç”¨åˆæˆæ•°æ®å¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒã€‚



## :handshake: æ¬¢è¿è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿å¯¹æˆ‘ä»¬çš„å¼€æºæ¡†æ¶è¿›è¡Œæ”¹è¿›è´¡çŒ®ï¼

